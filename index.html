<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jacked Classic Tracker</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom scrollbar for a cleaner look on mobile */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 4px;
        }
        body {
            background-color: #020617; /* slate-950 */
            overscroll-behavior-y: none; /* Prevent pull-to-refresh on mobile */
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- AUDIO ENGINE (Synthesized Beep for Reliability) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const playTimerBeep = () => {
            if (!audioCtx) return;
            
            // Resume context if suspended (browser autoplay policy)
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }

            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(880, audioCtx.currentTime); // High pitch (A5)
            oscillator.frequency.exponentialRampToValueAtTime(440, audioCtx.currentTime + 0.1); // Drop pitch

            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);

            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        };

        const initAudio = () => {
            // Call this on user interaction to unlock audio on mobile
            if (audioCtx && audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            // Play a silent sound to warm up the buffer
            const buffer = audioCtx.createBuffer(1, 1, 22050);
            const source = audioCtx.createBufferSource();
            source.buffer = buffer;
            source.connect(audioCtx.destination);
            source.start(0);
        };

        // --- ICONS (Inline SVGs) ---
        
        const ChevronRight = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m9 18 6-6-6-6"/></svg>
        );
        const TimerIcon = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="10" x2="14" y1="2" y2="2"/><line x1="12" x2="15" y1="14" y2="11"/><circle cx="12" cy="14" r="8"/></svg>
        );
        const Trophy = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
        );
        const Flame = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-2.246-5.318-1-7 1.879 2.375 5.5 5.875 5.5 10 0 1.57-.93 3.07-2.5 3.5a2.485 2.485 0 0 1-1.488-.135C8.846 14.925 8.5 14.5 8.5 14.5Z"/><path d="M17.5 15c0 3.037-2 5.5-4.5 5.5-2.5 0-5.5-2-5.5-6 0-3.5 3-5 5.5-8 2.5 3 4.5 4.963 4.5 8.5Z"/></svg>
        );
        const CheckCircle2 = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
        );
        const RefreshCw = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
        );
        const LogOut = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
        );
        const Minus = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M5 12h14"/></svg>
        );
        const Plus = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M5 12h14"/><path d="M12 5v14"/></svg>
        );

        // --- DATA STRUCTURE ---

        const WORKOUT_DATA = {
            PULL: [
                { id: 'A', base: 'DB Chest Supported Rows', variations: { JackedUp: '1.5 Reps', Jacked: 'Standard', JackedDown: 'Standard Rows', HLL: 'Incline Crush Grip' } },
                { id: 'B', base: 'DB Urlachers', variations: { JackedUp: '3 sec ISO Hold', Jacked: 'Standard', JackedDown: 'Seated High Pulls', HLL: 'High Pulls' } },
                { id: 'C', base: 'DB Haney Shrugs', variations: { JackedUp: '10 sec ISO Hold', Jacked: 'Standard', JackedDown: 'Lower Partials w/ 5 sec ISO', HLL: 'Standard Shrugs' } },
                { id: 'D', base: 'DB No Money Curls', variations: { JackedUp: 'Zottman Curls', Jacked: 'Standard', JackedDown: 'Alt. No Money Curls', HLL: 'Shovel Curls' } }
            ],
            PUSH: [
                { id: 'A', base: 'DB Bench Press', variations: { JackedUp: 'Paused (5 Sec)', Jacked: 'Standard', JackedDown: 'Upper Partials', HLL: 'Crush Grip' } },
                { id: 'B', base: 'DB Side Lateral Raises', variations: { JackedUp: '1.5 Reps', Jacked: 'Standard', JackedDown: 'Cheat Laterals', HLL: 'Abduction Rows' } },
                { id: 'C', base: 'Lying DB Tricep Ext', variations: { JackedUp: 'Stretch Ext', Jacked: 'Standard', JackedDown: 'JM Press', HLL: 'Floor Ext' } },
                { id: 'D', base: 'DB OHP', variations: { JackedUp: 'Z Press', Jacked: 'Standard', JackedDown: 'Push Press', HLL: 'Over and Backs' } }
            ],
            LEGS: [
                { id: 'A', base: 'Alt. Reverse Lunges', variations: { JackedUp: '1.5 Reps', Jacked: 'Standard', JackedDown: 'Partials (Knees)', HLL: 'Goblet Lunges' } },
                { id: 'B', base: 'DB Hip Thrusts', variations: { JackedUp: 'Marches', Jacked: 'Standard', JackedDown: 'Partials (Knees)', HLL: 'Single Leg' } },
                { id: 'C', base: 'DB Rocket Squats', variations: { JackedUp: 'Deep (Floor)', Jacked: 'Standard (Shins)', JackedDown: 'Partials (Knees)', HLL: 'Standard Squats' } },
                { id: 'D', base: 'DB RDLs', variations: { JackedUp: '1.5 Reps', Jacked: 'Standard', JackedDown: 'Upper Partials', HLL: 'Single Leg' } }
            ]
        };

        // --- HELPER LOGIC ---

        const getPathDetails = (reps) => {
            const r = parseInt(reps);
            if (isNaN(r)) return { path: 'Jacked', threshold: 6 };

            if (r >= 13) return { path: 'JackedUp', threshold: Math.ceil(r / 2) };
            if (r >= 10) return { path: 'Jacked', threshold: 6 };
            if (r >= 6) return { path: 'JackedDown', threshold: 6 };
            return { path: 'HLL', threshold: 6 };
        };

        const getRank = (score) => {
            if (score > 55) return { title: 'XTREME', color: 'text-purple-500', border: 'border-purple-500' };
            if (score >= 46) return { title: 'ELITE', color: 'text-red-500', border: 'border-red-500' };
            if (score >= 36) return { title: 'PRO', color: 'text-orange-500', border: 'border-orange-500' };
            if (score >= 20) return { title: 'SOLID', color: 'text-yellow-500', border: 'border-yellow-500' };
            return { title: 'BASIX', color: 'text-slate-400', border: 'border-slate-400' };
        };

        // --- MAIN COMPONENT ---

        function JackedClassicApp() {
            const [phase, setPhase] = useState('MENU');
            const [selectedDay, setSelectedDay] = useState(null);
            const [ignitorData, setIgnitorData] = useState({});
            
            // Workout State
            const [activeExercises, setActiveExercises] = useState([]);
            // In the new list view, we need to track inputs for ALL active exercises in the current round
            // structure: { [exerciseId]: string_reps }
            const [roundInputs, setRoundInputs] = useState({});
            
            const [score, setScore] = useState(0);
            const [round, setRound] = useState(1);
            const [eliminatedList, setEliminatedList] = useState([]);
            const [lastReps, setLastReps] = useState({}); // history for prepopulation
            const [giveUpConfirm, setGiveUpConfirm] = useState(false);
            
            // Timer State
            const [timeLeft, setTimeLeft] = useState(60);
            const [timerActive, setTimerActive] = useState(false);

            // Initialize Ignitor Data
            useEffect(() => {
                if (selectedDay) {
                    const initialData = {};
                    WORKOUT_DATA[selectedDay].forEach(ex => {
                        initialData[ex.id] = { weight: '', reps: '', path: 'Jacked', threshold: 6 };
                    });
                    setIgnitorData(initialData);
                }
            }, [selectedDay]);

            useEffect(() => {
                setGiveUpConfirm(false);
                // Scroll to top on phase change
                window.scrollTo(0, 0);
            }, [phase]);

            // Timer Logic
            useEffect(() => {
                let interval = null;
                if (timerActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft((prev) => prev - 1);
                    }, 1000);
                } else if (timeLeft === 0 && timerActive) {
                    setTimerActive(false);
                    // Play synthesized beep
                    playTimerBeep();
                    startNextRound();
                }
                return () => clearInterval(interval);
            }, [timerActive, timeLeft]);

            const handleStartIgnitor = (day) => {
                setSelectedDay(day);
                setPhase('IGNITOR');
            };

            const handleIgnitorChange = (id, field, value) => {
                const newData = { ...ignitorData };
                if (!newData[id]) {
                    newData[id] = { weight: '', reps: '', path: 'Jacked', threshold: 6 };
                }
                newData[id][field] = value;
                if (field === 'reps') {
                    const { path, threshold } = getPathDetails(value);
                    newData[id].path = path;
                    newData[id].threshold = threshold;
                }
                setIgnitorData(newData);
            };

            const adjustIgnitorValue = (id, field, amount) => {
                const currentVal = ignitorData[id]?.[field];
                const val = currentVal === '' ? 0 : parseInt(currentVal);
                const newVal = Math.max(0, val + amount);
                handleIgnitorChange(id, field, newVal.toString());
            };

            const startChallenge = () => {
                initAudio(); // Unlock audio context on first meaningful interaction
                const isValid = Object.values(ignitorData).every(d => d.weight && d.reps);
                if (!isValid) {
                    alert("Please fill in Weight and Reps for all exercises.");
                    return;
                }
                setActiveExercises(['A', 'B', 'C', 'D']);
                setEliminatedList([]);
                setLastReps({});
                setScore(0);
                setRound(1);
                
                // Initialize first round inputs (empty or prepopulate if we had history, but it's new game so empty)
                setRoundInputs({});
                setPhase('WORKOUT');
            };

            const handleGiveUp = () => {
                const remainingCasualties = activeExercises.map(id => ({
                    id,
                    round,
                    name: WORKOUT_DATA[selectedDay].find(ex => ex.id === id).base 
                }));
                setEliminatedList(prev => [...prev, ...remainingCasualties]);
                setPhase('RESULTS');
            };

            const requestGiveUp = () => {
                if (giveUpConfirm) {
                    handleGiveUp();
                } else {
                    setGiveUpConfirm(true);
                    setTimeout(() => setGiveUpConfirm(false), 3000);
                }
            };

            // Handling Rep inputs in the Workout List View
            const handleRoundInputChange = (id, val) => {
                setRoundInputs(prev => ({ ...prev, [id]: val }));
            };

            const adjustRoundReps = (id, amount, e) => {
                // Prevent button focus to stop keyboard from popping if it wasn't already up
                if (e) e.preventDefault(); 
                const currentVal = roundInputs[id] === '' || roundInputs[id] === undefined ? 0 : parseInt(roundInputs[id]);
                const newVal = Math.max(0, currentVal + amount);
                handleRoundInputChange(id, newVal.toString());
            };

            const submitRound = () => {
                let currentScore = score;
                let nextEliminated = [...eliminatedList];
                let nextActive = [];
                let nextLastReps = { ...lastReps };

                // Process each active exercise
                activeExercises.forEach(id => {
                    const inputVal = roundInputs[id];
                    const repsPerformed = inputVal === '' || inputVal === undefined ? 0 : parseInt(inputVal);
                    const exerciseData = ignitorData[id];
                    const threshold = exerciseData.threshold;
                    
                    // Save history
                    nextLastReps[id] = repsPerformed.toString();

                    if (repsPerformed < threshold) {
                        // Eliminate
                        nextEliminated.push({
                            id: id,
                            round: round,
                            name: WORKOUT_DATA[selectedDay].find(ex => ex.id === id).base
                        });
                    } else {
                        // Keep Active
                        nextActive.push(id);
                        currentScore += 1;
                    }
                });

                // Update State
                setScore(currentScore);
                setEliminatedList(nextEliminated);
                setLastReps(nextLastReps);
                setActiveExercises(nextActive);

                if (nextActive.length === 0) {
                    setPhase('RESULTS');
                } else {
                    // Go to Rest
                    setPhase('REST');
                    const isLastManStanding = nextActive.length === 1;
                    setTimeLeft(isLastManStanding ? 10 : 60);
                    setTimerActive(true);
                }
            };

            const startNextRound = () => {
                setRound(r => r + 1);
                // Prepopulate inputs with last successful reps
                const nextInputs = {};
                activeExercises.forEach(id => {
                    nextInputs[id] = lastReps[id] || '';
                });
                setRoundInputs(nextInputs);
                setPhase('WORKOUT');
            };

            const resetApp = () => {
                setPhase('MENU');
                setSelectedDay(null);
                setIgnitorData({});
                setLastReps({});
            };

            // --- COMPONENT: TOP BAR (PROGRESS) ---
            const TopBar = () => (
                <div className="flex justify-between items-center p-3 bg-slate-900 border-b border-slate-800 sticky top-0 z-20 shadow-md h-14">
                    <div className="text-xs font-mono text-slate-400">ROUND <span className="text-white text-base font-bold">{round}</span></div>
                    <div className="flex items-center gap-2 text-orange-500 font-mono font-bold text-lg"><Trophy className="w-4 h-4" /> {score}</div>
                </div>
            );

            // --- VIEWS ---

            if (phase === 'MENU') {
                return (
                    <div className="min-h-screen bg-slate-950 text-slate-100 font-sans p-6 flex flex-col justify-center items-center">
                        <div className="mb-8 text-center">
                            <h1 className="text-4xl font-black italic tracking-tighter text-orange-500 mb-2">JACKED</h1>
                            <h2 className="text-2xl font-bold tracking-widest text-slate-400">CLASSIC</h2>
                        </div>
                        <div className="grid gap-4 w-full max-w-sm">
                            {['PULL', 'PUSH', 'LEGS'].map(day => (
                                <button key={day} onClick={() => handleStartIgnitor(day)} className="bg-slate-800 hover:bg-slate-700 border-2 border-slate-700 hover:border-orange-500 text-xl font-bold py-6 rounded-xl transition-all shadow-lg active:scale-95 flex items-center justify-between px-6">
                                    <span>{day} DAY</span>
                                    <ChevronRight className="text-orange-500" />
                                </button>
                            ))}
                        </div>
                    </div>
                );
            }

            if (phase === 'IGNITOR') {
                return (
                    <div className="min-h-screen bg-slate-950 text-slate-100 pb-32">
                        <header className="flex justify-between items-center p-4 bg-slate-950 sticky top-0 z-10 border-b border-slate-800/50 backdrop-blur-sm">
                            <button onClick={() => setPhase('MENU')} className="text-slate-400 hover:text-white">Back</button>
                            <h2 className="text-xl font-bold text-orange-500">{selectedDay} // IGNITOR</h2>
                        </header>
                        <div className="p-4 space-y-6">
                            <div className="bg-slate-900/50 p-4 rounded-lg text-sm text-slate-400 border border-slate-800 space-y-2">
                                <p>Set your Base Weight & Max Reps. This determines your Path and X-tinction Threshold.</p>
                                <div className="flex items-center gap-2 text-orange-400 font-semibold">
                                    <TimerIcon className="w-4 h-4" />
                                    <span>Rest 2 minutes between each ignitor set.</span>
                                </div>
                            </div>
                            {WORKOUT_DATA[selectedDay].map((ex) => {
                                const data = ignitorData[ex.id] || { path: 'Jacked', threshold: 6 };
                                const pathColor = data.path === 'JackedUp' ? 'text-purple-400' : data.path === 'Jacked' ? 'text-green-400' : data.path === 'JackedDown' ? 'text-yellow-400' : 'text-red-400';
                                return (
                                    <div key={ex.id} className="bg-slate-800 rounded-xl p-4 shadow-md border border-slate-700">
                                        <div className="flex justify-between items-start mb-3">
                                            <h3 className="font-bold text-lg leading-tight w-2/3">{ex.base}</h3>
                                            <div className="text-right">
                                                <span className={`text-xs font-black uppercase tracking-wider ${pathColor}`}>{data.path}</span>
                                                <div className="text-xs text-slate-500">Threshold: {data.threshold}</div>
                                            </div>
                                        </div>
                                        <div className="space-y-6">
                                            <div>
                                                <label className="text-xs text-slate-400 block mb-2 text-center font-bold uppercase">Weight (lbs)</label>
                                                <div className="flex items-center justify-between gap-2">
                                                    <div className="flex gap-1">
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'weight', -5)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Minus className="w-4 h-4"/></button>
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'weight', -1)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Minus className="w-4 h-4"/></button>
                                                    </div>
                                                    <input type="number" placeholder="0" className="w-full bg-slate-950 border border-slate-600 rounded p-3 text-xl font-mono text-center focus:border-orange-500 outline-none" value={ignitorData[ex.id]?.weight || ''} onChange={(e) => handleIgnitorChange(ex.id, 'weight', e.target.value)} />
                                                    <div className="flex gap-1">
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'weight', 1)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Plus className="w-4 h-4"/></button>
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'weight', 5)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Plus className="w-4 h-4"/></button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <label className="text-xs text-slate-400 block mb-2 text-center font-bold uppercase">Max Reps</label>
                                                <div className="flex items-center justify-between gap-2">
                                                    <div className="flex gap-1">
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'reps', -5)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Minus className="w-4 h-4"/></button>
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'reps', -1)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Minus className="w-4 h-4"/></button>
                                                    </div>
                                                    <input type="number" placeholder="0" className="w-full bg-slate-950 border border-slate-600 rounded p-3 text-xl font-mono text-center focus:border-orange-500 outline-none" value={ignitorData[ex.id]?.reps || ''} onChange={(e) => handleIgnitorChange(ex.id, 'reps', e.target.value)} />
                                                    <div className="flex gap-1">
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'reps', 1)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Plus className="w-4 h-4"/></button>
                                                        <button onClick={() => adjustIgnitorValue(ex.id, 'reps', 5)} className="bg-slate-900 hover:bg-slate-700 text-slate-400 hover:text-white p-3 rounded-lg active:scale-95 font-bold transition-all"><Plus className="w-4 h-4"/></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                        <div className="fixed bottom-0 left-0 w-full p-4 bg-slate-950 border-t border-slate-800 z-20">
                            <button onClick={startChallenge} className="w-full bg-orange-600 hover:bg-orange-500 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 flex justify-center items-center gap-2">
                                <Flame className="w-5 h-5 fill-current" />
                                START CHALLENGE
                            </button>
                        </div>
                    </div>
                );
            }

            if (phase === 'WORKOUT') {
                return (
                    <div className="min-h-screen bg-slate-950 text-slate-100 flex flex-col pb-40">
                        <TopBar />
                        
                        <main className="flex-1 p-2 space-y-3">
                            {activeExercises.map((id) => {
                                const exData = WORKOUT_DATA[selectedDay].find(e => e.id === id);
                                const userExData = ignitorData[id];
                                const pathColor = userExData.path === 'JackedUp' ? 'text-purple-400 border-purple-500/30 bg-purple-500/10' : userExData.path === 'Jacked' ? 'text-green-400 border-green-500/30 bg-green-500/10' : userExData.path === 'JackedDown' ? 'text-yellow-400 border-yellow-500/30 bg-yellow-500/10' : 'text-red-400 border-red-500/30 bg-red-500/10';
                                
                                return (
                                    <div key={id} className="bg-slate-900/50 rounded-xl border border-slate-800 p-3">
                                        <div className="flex items-baseline justify-between mb-2">
                                            <h2 className="text-lg font-black leading-tight text-white">{exData.base}</h2>
                                            <div className={`ml-2 px-1.5 py-0.5 rounded border text-[9px] font-black tracking-widest uppercase shrink-0 ${pathColor}`}>
                                                {userExData.path}
                                            </div>
                                        </div>

                                        <div className="flex items-center gap-2">
                                            {/* Compact Stats Block */}
                                            <div className="flex flex-col gap-1 shrink-0">
                                                <div className="bg-slate-800 rounded px-2 py-1 text-center min-w-[60px]">
                                                    <div className="text-[9px] text-slate-500 uppercase font-bold leading-none mb-0.5">LBS</div>
                                                    <div className="text-sm font-mono font-bold text-white leading-none">{userExData.weight}</div>
                                                </div>
                                                <div className="bg-slate-900 border border-slate-800 rounded px-2 py-1 text-center min-w-[60px]">
                                                    <div className="text-[9px] text-slate-500 uppercase font-bold leading-none mb-0.5">Goal</div>
                                                    <div className="text-sm font-mono font-bold text-red-500 leading-none">&gt; {userExData.threshold}</div>
                                                </div>
                                            </div>

                                            {/* Input Area */}
                                            <div className="flex-1 bg-slate-800/30 rounded-lg p-1.5 flex items-center justify-between">
                                                <div className="flex gap-1">
                                                    <button onMouseDown={(e) => adjustRoundReps(id, -5, e)} className="h-8 w-8 flex items-center justify-center bg-slate-800 text-slate-400 rounded active:bg-slate-700 active:text-white transition-colors"><Minus className="w-3 h-3"/></button>
                                                    <button onMouseDown={(e) => adjustRoundReps(id, -1, e)} className="h-8 w-8 flex items-center justify-center bg-slate-800 text-slate-400 rounded active:bg-slate-700 active:text-white transition-colors"><Minus className="w-3 h-3"/></button>
                                                </div>
                                                
                                                <input 
                                                    type="number" 
                                                    inputMode="numeric"
                                                    placeholder="0"
                                                    className="w-12 bg-transparent text-center text-2xl font-black text-white outline-none placeholder-slate-700"
                                                    value={roundInputs[id] || ''}
                                                    onChange={(e) => handleRoundInputChange(id, e.target.value)}
                                                />

                                                <div className="flex gap-1">
                                                    <button onMouseDown={(e) => adjustRoundReps(id, 1, e)} className="h-8 w-8 flex items-center justify-center bg-slate-800 text-slate-400 rounded active:bg-slate-700 active:text-white transition-colors"><Plus className="w-3 h-3"/></button>
                                                    <button onMouseDown={(e) => adjustRoundReps(id, 5, e)} className="h-8 w-8 flex items-center justify-center bg-slate-800 text-slate-400 rounded active:bg-slate-700 active:text-white transition-colors"><Plus className="w-3 h-3"/></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </main>

                        <div className="fixed bottom-0 left-0 w-full p-4 bg-slate-950 border-t border-slate-800 z-20 space-y-3">
                            <button 
                                onClick={submitRound}
                                className="w-full bg-orange-600 text-white font-bold text-lg py-4 rounded-2xl shadow-lg active:scale-95 transition-all flex justify-center items-center gap-2"
                            >
                                COMPLETE ROUND <CheckCircle2 className="w-6 h-6" />
                            </button>

                            <button
                                onClick={requestGiveUp}
                                className={`w-full text-xs font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 ${
                                    giveUpConfirm 
                                    ? 'bg-red-500/10 text-red-500 border border-red-500/50' 
                                    : 'text-slate-600 hover:text-slate-400'
                                }`}
                            >
                                {giveUpConfirm ? 'CONFIRM END?' : 'End Challenge'} {giveUpConfirm && <LogOut className="w-3 h-3" />}
                            </button>
                        </div>
                    </div>
                );
            }

            if (phase === 'REST') {
                const isLastMan = activeExercises.length === 1;
                // Preview the next set of exercises (which is just the active list again)
                
                return (
                    <div className={`min-h-screen ${isLastMan ? 'bg-red-950' : 'bg-slate-950'} text-white flex flex-col`}>
                        <TopBar />
                        {isLastMan && <div className="absolute inset-0 animate-pulse bg-red-900/20 pointer-events-none"></div>}
                        
                        <div className="flex-1 flex flex-col items-center justify-center p-6 relative z-10">
                            <div className="mb-4 font-black tracking-widest text-slate-400 uppercase">{isLastMan ? 'LAST MAN STANDING' : 'REST'}</div>
                            <div className="relative w-48 h-48 mx-auto flex items-center justify-center border-8 border-slate-800 rounded-full mb-12 bg-slate-900/50 backdrop-blur">
                                <svg className="absolute top-0 left-0 w-full h-full -rotate-90">
                                    <circle cx="90" cy="90" r="86" fill="none" stroke={isLastMan ? '#ef4444' : '#f97316'} strokeWidth="6" strokeDasharray="540" strokeDashoffset={540 - (540 * timeLeft) / (isLastMan ? 10 : 60)} className="transition-all duration-1000 ease-linear" />
                                </svg>
                                <div className="text-6xl font-mono font-bold">{timeLeft}</div>
                            </div>
                            
                            <div className="bg-slate-900/80 p-6 rounded-2xl border border-slate-700/50 backdrop-blur-sm relative w-full max-w-sm text-center">
                                <div className="text-xs uppercase text-slate-500 font-bold mb-2">Up Next</div>
                                <h3 className="text-xl font-black text-white">Round {round + 1}</h3>
                                <p className="text-slate-400 text-sm mt-1">{activeExercises.length} Exercises Remaining</p>
                            </div>

                            <div className="flex flex-col gap-3 mt-12 w-full max-w-sm">
                                <button onClick={() => setTimeLeft(0)} className="text-white bg-slate-800 hover:bg-slate-700 font-bold py-4 px-6 rounded-xl transition-colors w-full">Skip Rest</button>
                                <button onClick={requestGiveUp} className={`text-xs font-bold py-3 px-6 rounded-xl transition-all w-full ${giveUpConfirm ? 'text-red-500 bg-red-500/10' : 'text-slate-500 hover:text-slate-300'}`}>
                                    {giveUpConfirm ? 'CONFIRM END?' : 'End Challenge'}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (phase === 'RESULTS') {
                const rank = getRank(score);
                return (
                    <div className="min-h-screen bg-slate-950 text-white p-6 flex flex-col items-center justify-center">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-black italic text-slate-700 mb-2">GAME OVER</h1>
                            <p className="text-slate-400">All exercises X-tinct</p>
                        </div>
                        <div className={`relative w-64 h-64 flex flex-col items-center justify-center border-4 ${rank.border} rounded-full bg-slate-900 mb-6 shadow-2xl shadow-${rank.color}/20`}>
                            <div className="text-sm text-slate-500 font-bold uppercase tracking-widest mb-1">Total Score</div>
                            <div className="text-7xl font-black mb-2">{score}</div>
                            <div className={`text-2xl font-black tracking-tighter ${rank.color} bg-white/5 px-4 py-1 rounded-lg`}>{rank.title}</div>
                        </div>
                        <div className="w-full max-w-sm grid grid-cols-2 gap-4 mb-8">
                            <div className="bg-slate-900 p-4 rounded-xl border border-slate-800 text-center">
                                <div className="text-xs text-slate-500 uppercase">Rounds</div>
                                <div className="text-2xl font-bold">{round}</div>
                            </div>
                            <div className="bg-slate-900 p-4 rounded-xl border border-slate-800 text-center">
                                <div className="text-xs text-slate-500 uppercase">Eliminated</div>
                                <div className="text-2xl font-bold text-red-500">{eliminatedList.length}<span className="text-sm text-slate-600">/4</span></div>
                            </div>
                        </div>
                        <div className="w-full max-w-sm bg-slate-900 rounded-xl p-4 border border-slate-800 mb-8 max-h-60 overflow-y-auto">
                            <h3 className="text-xs font-bold text-slate-500 uppercase mb-3">Casualty Report</h3>
                            <div className="space-y-2">
                                {eliminatedList.map((item, idx) => (
                                    <div key={idx} className="flex justify-between items-center text-sm">
                                        <span className="text-slate-300">{item.name}</span>
                                        <span className="text-red-500 font-mono text-xs">Round {item.round}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                        <button onClick={resetApp} className="bg-slate-800 hover:bg-slate-700 text-white font-bold py-4 px-8 rounded-xl flex items-center gap-2 transition-colors w-full justify-center">
                            <RefreshCw className="w-5 h-5" /> Play Again
                        </button>
                    </div>
                );
            }

            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <>
                <JackedClassicApp />
            </>
        );
    </script>
</body>
</html>
